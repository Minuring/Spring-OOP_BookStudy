# 2장 자바와 절차적/구조적 프로그래밍

## 📝 정리

### 1. 자바 프로그램의 개발과 구동
- JDK로 개발된 프로그램은 JRE에 의해 가상 컴퓨터인 JVM 상에서 구동된다.
- Write Once Run Anywhere
- 프로그램은 메모리를 코드 실행 영역과 데이터 저장 영역으로 나누어 사용한다.
  - 데이터 저장 영역은 **스태틱 영역, 스택 영역, 힙 영역**으로 나눈다. 이를 T메모리라고 지칭

### 2. 자바에 존재하는 절차적/구조적 프로그래밍의 유산
- 절차적 프로그래밍 : **goto를 쓰지 말라**. 논리적으로 잘 구성하면 쓸 필요가 없다. 
- 구조적 프로그래밍 : **함수를 써라**. 중복 코드 관리, 논리나 단위를 분할
- 함수와 메서드는 다르지 않다.
  - 그래도 차이점을 찾는다면 메서드는 반드시 클래스 정의 안에 존재

#### 3. 다시 보는 main()메서드 : 메서드 스택 프레임
- __자바 프로그래램을 실행하면__
  1. JRE는 main()메서드를 찾는다.
  2. main()메서드가 있으면 JRE는 JVM을 부팅한다.
  3. 부팅된 JVM은 목적 파일을 받아 **전처리**과정을 수행한다.
     - java.lang 패키지를 T메모리의 스태틱 영역에 가져온다.
     - 개발자가 작성한 모든 클래스와 import 패키지도 스태틱 영역에 가져온다.
  4. T메모리의 스택 영역에 **main()메서드 스택 프레임**이 할당된다.
     - 코드에서 여는 중괄호 `{` 를 만날 때마다 스택 프레임이 형성된다. 
  5. main()메서드의 인자 `args`의 변수 공간이 스택 프레임 내에 할당된다.
  6. main()메서드의 첫 명령문을 실행한다.
  7. main()메서드의 실행을 마치면 JRE는 JVM을 종료하고 OS상의 메모리에서 사라진다.

### 4. 변수와 메모리 : 변수! 너 어디 있니?
- 메서드 내에서 만든 변수는 해당 메서드 스택 프레임에 공간이 할당된다.

### 5. 블록 구문과 메모리 : 블록 스택 프레임
- if문 등의 중괄호를 만나면 블록 스택 프레임이 형성된다.
- 블록이 닫히면 해당 블록 스택 프레임은 소멸한다.

### 6. 지역 변수와 메모리: 스택 프레임에 갇혔어요!
- 지역 변수는 스택 프레임 안에서 일생을 보낸다.
> "외부 스택 프레임에서 내부 스택 프레임의 변수에 접근하는 것은 불가능하나 그 역은 가능하다"

### 7. 메서드 호출과 메모리: 메서드 스택 프레임2
- 메서드 호출이 일어나면 해당 메서드의 스택 프레임이 스택 영역에 형성된다.
- **Call By Value** : 이름이 같아도 실제로는 별도의 변수이다.
- **입력값과 반환값에 의해 값이 전달될 뿐 서로 다른 메서드가 서로의 지역 변수를 볼 수 없다**

### 8. 전역 변수와 메모리: 전역 변수 쓰지 말라니까요!
- 메서드 밖에서 선언된 변수는 전역 변수가 된다.
- 여러 메서드에서 전역 변수를 건드리면, 추적 및 파악하기가 쉽지 않다.
- **전역 변수는 피할 수 있다면 피해야 할 존재이다.**
  - 다만 읽기 전용으로 전역 상수로 쓰는 것은 적극 추천한다.**

### 9. 멀티 스레드 / 멀티 프로세스의 이해
- **멀티 스레드**: 스택 영역을 스레드 개수만큼 분할해서 쓰는 것
- **멀티 프로세스**: 다수의 T메모리를 갖는 구조
- 멀티 스레드에서 전역 변수 사용은 문제가 발생할 위험이 있다.
  - **락** : 전역 변수를 사용중이면 다른 스레드의 접근을 차단한다.
  - 하지만 락 자체의 오버헤드, 기아 문제, 데드락 문제를 방지해야한다.

### 필드 vs 속성, 함수 vs 메서드
- 사실 같다. 객체 지향에서 차별화를 위해 다르게 불렀다고 한다.

---

## 🎞 회고

자바 프로그램의 구동 과정, main()메서드가 실행되는 과정을 자세히 알게 되었다.
메서드가 스택 프레임에 형성된다는 점,
if문의 경우 참/거짓에 따라 한 쪽 블럭만 스택 프레임이 형성된다는 점도 처음 알았다.

그리고 전역 변수의 사용이 위험하다는 점을 읽고 이때까지 내가 하던 코딩을 돌아보게 되었다.
함수와 메서드의 차이처럼 궁금했지만 찾아보지 않았던 것들 또한 알게되었다.

이번 장은 새로이 알게된 점, 자세히 알게된 점들이 많았다.
자바를 겉으로만 알고있던 것 같다. 이렇게 깊은 내용을 알게 되서 많은 도움이 되었다.